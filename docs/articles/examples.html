<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using the SSIndex package • SSIndex</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using the SSIndex package">
<meta property="og:description" content="SSIndex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SSIndex</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Using the SSIndex package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="examples_files/header-attrs-2.5/header-attrs.js"></script><script src="examples_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="examples_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="examples_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using the SSIndex package</h1>
                        <h4 class="author">Sy Han (Steven) Chiou</h4>
            
            <h4 class="date">2020-12-11</h4>
      
      
      <div class="hidden name"><code>examples.Rmd</code></div>

    </div>

    
    
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script><p>In this vignette, we demonstrate the usage of the <strong><code>SSIndex</code></strong> package. The implementations provided in the <strong><code>SSIndex</code></strong> package are based on the working manuscript titled “Statistical inference on shape- and size-indexes for counting processes”.</p>
<div id="notations" class="section level2">
<h2 class="hasAnchor">
<a href="#notations" class="anchor"></a>Notations</h2>
<p>Let <span class="math inline">\(N^\ast(t)\)</span> be the number of events occurring at or before time <span class="math inline">\(t\)</span> and <span class="math inline">\(X\)</span> is a <span class="math inline">\(p\times1\)</span> vector of baseline covariate. We consider a semi-parametric model for the conditional rate function of <span class="math inline">\(N^\ast(\cdot)\)</span>: <span class="math display">\[\lambda(t|X) = f(t, \beta_0^\top X) g(\gamma_0^\top X), 0\le t \le \tau, \]</span> where <span class="math inline">\([0, \tau]\)</span> is the study period of interest, <span class="math inline">\(f(\cdot, a)\)</span> is an unspecified density function for <span class="math inline">\(a\in\mathcal R\)</span>, and <span class="math inline">\(g(\cdot)\)</span> is an unspecified function. We denote the regression parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\gamma_0\)</span> the shape and size parameters, respectively. Similar, we denote the linear combinations <span class="math inline">\(\beta_0^\top X\)</span> and <span class="math inline">\(\gamma_0^\top X\)</span> the shape-index and size-index, respectively. Let <span class="math inline">\(F(t, a) = \int_0^tf(u, a)du\)</span>, we impose the assumptions:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(g(\gamma_0^\top X)\)</span> is increasing in <span class="math inline">\(\gamma_0^\top X\)</span>.</li>
<li>For any <span class="math inline">\(t\in[0, \tau]\)</span>, the the reversed hazard function corresponding to the shape function, defined as <span class="math inline">\(r(t, \beta_0^\top X) = f(t, \beta_0^\top X) / F(t, \beta_0^\top X)\)</span> is decreasing in <span class="math inline">\(\beta_0^\top X\)</span>.</li>
</ol>
<p>We use the <code><a href="../reference/simDat.html">simDat()</a></code> to generate simulated data descriptive in the manuscript and use the <code>gsm()</code> to obtain the point estimators for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\gamma_0\)</span>.</p>
</div>
<div id="simulating-recurrent-event-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-recurrent-event-data" class="anchor"></a>Simulating recurrent event data</h2>
<p>We use the <code><a href="../reference/simDat.html">simDat()</a></code> function to generate the simulated data used in the manuscript. The syntax of <code><a href="../reference/simDat.html">simDat()</a></code> is</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">args</span>(SSIndex<span class="op">::</span>simDat)</span></code></pre></div>
<pre><code>function (n, model, frailty = FALSE, ...) 
NULL</code></pre>
<p>The arguments are:</p>
<ul>
<li>
<code>n</code> is an integer value representing sample size</li>
<li>
<code>model</code> is a character string indicating the models described below.</li>
<li>
<code>frailty</code> is a logical value indicating whether to generate the data under informative censoring</li>
</ul>
<p>We consider generating recurrent events from the following rate functions as proposed in the simulation study of the manuscript.</p>
<p>(M1) <span class="math inline">\(\lambda(t|X,Z) = Z(1 + t)^{-1} + 0.5Z\exp{(b^\intercal X)}\)</span>, <span class="math inline">\(\beta_0 = -b\)</span>, <span class="math inline">\(\gamma_0 = b\)</span>;</p>
<p>(M2) <span class="math inline">\(\lambda(t|X,Z) =Z\exp\{-0.5t\exp({-b^\intercal X})\}\)</span>, <span class="math inline">\(\beta_0 = b\)</span>, <span class="math inline">\(\gamma_0 = -b\)</span>;</p>
<p>(M3) <span class="math inline">\(\lambda(t | X, Z) = 0.5Z\log[\exp(b^\intercal X) + 1](1 + 0.5t)^{\{\log[\exp(b^\intercal X) + 1] - 1\}}\)</span>, <span class="math inline">\(\beta_0 = -b\)</span>, <span class="math inline">\(\gamma_0 = b\)</span>;</p>
<p>(M4) <span class="math inline">\(\lambda(t|X,Z) = Zf_B(t,\beta_0^\intercal X)\exp(\gamma_0^\intercal X)\)</span>, for <span class="math inline">\(t \in[0, 1]\)</span>, where <span class="math inline">\(f_B(\cdot,a) \propto x(1-x)^{\exp(a)}\)</span> is a Beta density function, <span class="math inline">\(\beta_0 = (0.6, 0.8)^\top\)</span>, and <span class="math inline">\(\gamma_0 = (0.28, 0.96)^\top\)</span>.</p>
<p>We set <span class="math inline">\(b = (0.6, 0.8)\)</span> in (M1)-(M3). For each setting, we consider two covariates and <span class="math inline">\(X = (X_1, X_2)^\intercal\)</span>, where <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent standard normal random variables. The censoring time was generated from an exponential distribution with mean <span class="math inline">\(10 (1 + |X_1|) / Z\)</span>, where the subject-specific latent variable <span class="math inline">\(Z\)</span> was either set as <span class="math inline">\(Z \equiv 1\)</span> (<code>frailty = TRUE</code>) or generated from an exponential distribution with mean 1 (<code>frailty = FALSE</code>). Thus, in the latter case, the censoring time is correlated with the recurrent event process through both <span class="math inline">\(X\)</span> and <span class="math inline">\(Z\)</span>. The following code provides an simulated data set with 200 samples under model (M4) and the non-informative censoring assumption.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">library</span>(SSIndex)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">set.seed</span>(<span class="dv">0</span>); dat &lt;-<span class="st"> </span><span class="kw">simDat</span>(<span class="dv">200</span>, <span class="st">"M4"</span>, <span class="ot">FALSE</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">head</span>(dat)</span></code></pre></div>
<pre><code># A tibble: 6 x 7
     id   Time     m    x1    x2 event status
  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1     1 0.0537    10 0.326  1.26     1      0
2     1 0.170     10 0.326  1.26     1      0
3     1 0.208     10 0.326  1.26     1      0
4     1 0.225     10 0.326  1.26     1      0
5     1 0.254     10 0.326  1.26     1      0
6     1 0.259     10 0.326  1.26     1      0</code></pre>
<p>The <code><a href="../reference/simDat.html">simDat()</a></code> returns a data.frame with 7 columns. The variables (columns) are defined below:</p>
<ul>
<li>
<code>id</code> is subject’s identity</li>
<li>
<code>time</code> marks the recurrent event time when <code>event = 1</code> or censoring time when <code>event = 0</code>
</li>
<li>
<code>m</code> is the number of recurrent events observed by the subject during the study period</li>
<li>
<code>x1</code> and <code>x2</code> are the covaraites</li>
<li>
<code>event</code> is the recurrent event indicator; <code>event = 1</code> denotes a recurrent event, and <code>event = 0</code> otherwise.</li>
<li>
<code>status</code> is 1 - <code>event</code>
</li>
</ul>
</div>
<div id="estimating-the-shape-and-size-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#estimating-the-shape-and-size-parameters" class="anchor"></a>Estimating the shape and size parameters</h2>
<p>The main function in <strong><code>SSIndex</code></strong> package is <code><a href="../reference/ssfit.html">ssfit()</a></code>. The arguments for the <code><a href="../reference/ssfit.html">ssfit()</a></code> function are</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">args</span>(ssfit)</span></code></pre></div>
<pre><code>function (formula, data, shp.ind = FALSE, bIni = NULL, rIni = NULL, 
    optMethod = NULL, smoothFirst = NULL) 
NULL</code></pre>
<ul>
<li>
<code>formula</code> is a formula object, with the response on the left of a <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> operator.</li>
<li>
<code>data</code> is an optional argument for data.</li>
<li>
<code>shp.ind</code> is a character string indicating either to proceed with shape-independence assumption.</li>
<li>
<code>B</code> is a numerical value specifying number of bootstrap in shape independence testing.</li>
<li>
<code>bIni</code> is the initial value for estimating the shape parameter</li>
<li>
<code>rIni</code> is the initial value for estimating the size parameter</li>
<li>
<code>smoothFirst</code> estimate the smooth estimator first and use it to guide? Default: <code>FALSE</code> when <span class="math inline">\(p = 1\)</span>, <code>TRUE</code> when <span class="math inline">\(p &gt; 1\)</span>
</li>
<li>
<code>opt</code> how many optimization methods to try? 1: <code>optim</code> 2: <code>optim</code> + <code><a href="https://rdrr.io/pkg/BB/man/spg.html">BB::spg</a></code> Default: 1 when <span class="math inline">\(p = 1\)</span>, 2 when <span class="math inline">\(p &gt; 1\)</span>
</li>
</ul>
<p>Since the proposed estimating procedure is a two-step rank-based estimation procedure that esitmates the shape parameter first, setting <code>shp.ind = TRUE</code> would assume <span class="math inline">\(\beta = 0\)</span>. The default initial values used in the estimation are 0-vectors and other initial values could be specified via <code>bIni</code> and <code>rIni</code>. The proposed estimating procedure involves optimizing non-smooth objective functions. When <code>smoothFirst = TRUE</code>, an induced smoothing technique is applied to the non-smooth objective functions and the optimization will be applied to the smoothed objective functions. The parameter estimates obtained from optimizing the smoothed objective functions will be used as the initial values in the optimization of the proposed non-smooth objective functions. In our simulation study, we found setting <code>smoothFirst = TRUE</code> could yield a slightly more stable results when <span class="math inline">\(p &gt; 1\)</span>.</p>
<p>The following gives an example code to fit the simulated data <code>dat</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="op">&gt;</span><span class="st"> </span>fm &lt;-<span class="st"> </span><span class="kw">reSurv</span>(<span class="dt">time1 =</span> Time, <span class="dt">id =</span> id, <span class="dt">event =</span> event, <span class="dt">status =</span> status) <span class="op">~</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="op">&gt;</span><span class="st"> </span>fit &lt;-<span class="st"> </span><span class="kw">ssfit</span>(fm, <span class="dt">data =</span> dat, <span class="dt">shp.ind =</span> <span class="ot">FALSE</span>, <span class="dt">smoothFirst =</span> <span class="ot">TRUE</span>, <span class="dt">optMethod =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>The above example defines the <code>formula</code> using the <code>reSurv()</code> function from the <code>reReg</code> package. The <code>reSurv()</code> is used to create a recurrent event object, see <code><a href="https://rdrr.io/pkg/reReg/man/reSurv.html">?reReg::reSurv</a></code>. While <code>reSurv()</code> serves the propose here, it is deprecated in <code>reReg</code> version 1.1.6.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">names</span>(fit)</span></code></pre></div>
<pre><code>[1] "b0"   "r0"   "b00"  "r00"  "Fhat"</code></pre>
<p>The <code><a href="../reference/ssfit.html">ssfit()</a></code> function returns a list of five elements. They are</p>
<ul>
<li>
<code>b0</code> is the shape parameter estimate obtained by optimizing the smooth objective functions; this is <code>NULL</code> if <code>smoothFirst = FALSE</code>.</li>
<li>
<code>r0</code> is the size parameter estimate obtained by optimizing the smooth objective functions; this is <code>NULL</code> if <code>smoothFirst = FALSE</code>.</li>
<li>
<code>b00</code> is the shape parameter estimate obtained by optimizing the nonsmooth objective functions using the smoothed estimator as the initial value (if it is available).</li>
<li>
<code>b00</code> is the size parameter estimate obtained by optimizing the nonsmooth objective functions using the smoothed estimator as the initial value (if it is available).</li>
<li>
<code>Fhat</code> is the estimate of <span class="math inline">\(\widehat F(Y_i, \widehat\beta^\top X_i)\)</span>, where <span class="math inline">\(Y_i\)</span> is the censoring time for the <span class="math inline">\(i\)</span>th subject and <span class="math inline">\(\widehat\beta\)</span> is the shape parameter estimate from <code>b00</code>.</li>
</ul>
<p>In this case, the point estimates are</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="op">&gt;</span><span class="st"> </span>tab &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">with</span>(fit, <span class="kw">c</span>(b0, r0, b00, r00)), <span class="dv">4</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">rownames</span>(tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"b1"</span>, <span class="st">"b2"</span>, <span class="st">"r1"</span>, <span class="st">"r2"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="op">&gt;</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>(tab, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">"smooth"</span>, <span class="st">"non-smooth"</span>))</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">smooth</th>
<th align="right">non-smooth</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">b1</td>
<td align="right">0.5637334</td>
<td align="right">0.5628135</td>
</tr>
<tr class="even">
<td align="left">b2</td>
<td align="right">0.8259568</td>
<td align="right">0.8265839</td>
</tr>
<tr class="odd">
<td align="left">r1</td>
<td align="right">0.2804429</td>
<td align="right">0.2831104</td>
</tr>
<tr class="even">
<td align="left">r2</td>
<td align="right">0.9598707</td>
<td align="right">0.9590873</td>
</tr>
</tbody>
</table>
</div>
<div id="inference" class="section level2">
<h2 class="hasAnchor">
<a href="#inference" class="anchor"></a>Inference</h2>
<p>Non-parametric bootstrap is applied to obtain the standard errors for the shape and size esitmates. For example, the following implementation can be used to obtain the standard errors with 100 bootstrap samples:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="op">&gt;</span><span class="st"> </span>bootSE &lt;-<span class="st"> </span><span class="cf">function</span>(dat) {</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="op">+</span><span class="st">   </span>n &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">unique</span>(dat<span class="op">$</span>id))</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="op">+</span><span class="st">   </span>mm &lt;-<span class="st"> </span><span class="kw">aggregate</span>(event <span class="op">~</span><span class="st"> </span>id, dat, sum)[, <span class="dv">2</span>]</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="op">+</span><span class="st">   </span>ind &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="op">+</span><span class="st">   </span>dat0 &lt;-<span class="st"> </span>dat[<span class="kw">unlist</span>(<span class="kw">sapply</span>(ind, <span class="cf">function</span>(x) <span class="kw">which</span>(dat<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span>x))),]</span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="op">+</span><span class="st">   </span><span class="co">## Break ties</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="op">+</span><span class="st">   </span>dat0<span class="op">$</span>Time[<span class="kw">duplicated</span>(dat0<span class="op">$</span>Time) <span class="op">&amp;</span><span class="st"> </span>dat0<span class="op">$</span>Time <span class="op">&lt;</span><span class="st"> </span><span class="kw">max</span>(dat0<span class="op">$</span>Time)] &lt;-</span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="op">+</span><span class="st">     </span>dat0<span class="op">$</span>Time[<span class="kw">duplicated</span>(dat0<span class="op">$</span>Time) <span class="op">&amp;</span><span class="st"> </span>dat0<span class="op">$</span>Time <span class="op">&lt;</span><span class="st"> </span><span class="kw">max</span>(dat0<span class="op">$</span>Time)] <span class="op">+</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="op">+</span><span class="st">     </span><span class="kw">rnorm</span>(<span class="kw">sum</span>(<span class="kw">duplicated</span>(dat0<span class="op">$</span>Time) <span class="op">&amp;</span><span class="st"> </span>dat0<span class="op">$</span>Time <span class="op">&lt;</span><span class="st"> </span><span class="kw">max</span>(dat0<span class="op">$</span>Time)), <span class="dt">sd =</span> <span class="fl">.001</span>)</span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="op">+</span><span class="st">   </span>dat0<span class="op">$</span>id &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n, mm[ind] <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="op">+</span><span class="st">   </span>fit0 &lt;-<span class="st"> </span><span class="kw">ssfit</span>(fm, <span class="dt">data =</span> dat0, <span class="dt">shp.ind =</span> <span class="ot">FALSE</span>, <span class="dt">bIni =</span> fit<span class="op">$</span>b00, <span class="dt">rIni =</span> fit<span class="op">$</span>r00, <span class="dt">smoothFirst =</span> <span class="ot">TRUE</span>, <span class="dt">optMethod =</span> <span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="op">+</span><span class="st">   </span><span class="kw">with</span>(fit0, <span class="kw">c</span>(b0, r0, b00, r00))</span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="op">+</span><span class="st"> </span>} </span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="op">&gt;</span><span class="st"> </span>b &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>, <span class="kw">bootSE</span>(dat))</span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="op">&gt;</span><span class="st"> </span>tab &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(b, <span class="dv">1</span>, sd), <span class="dv">4</span>)</span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="op">&gt;</span><span class="st"> </span><span class="kw">rownames</span>(tab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">"b1"</span>, <span class="st">"b2"</span>, <span class="st">"r1"</span>, <span class="st">"r2"</span>)</span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="op">&gt;</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>(tab, <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">"smooth"</span>, <span class="st">"non-smooth"</span>))</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">smooth</th>
<th align="right">non-smooth</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">b1</td>
<td align="right">0.0442714</td>
<td align="right">0.0450000</td>
</tr>
<tr class="even">
<td align="left">b2</td>
<td align="right">0.0275350</td>
<td align="right">0.0279316</td>
</tr>
<tr class="odd">
<td align="left">r1</td>
<td align="right">0.0287365</td>
<td align="right">0.0314870</td>
</tr>
<tr class="even">
<td align="left">r2</td>
<td align="right">0.0084522</td>
<td align="right">0.0093636</td>
</tr>
</tbody>
</table>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steven Chiou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
